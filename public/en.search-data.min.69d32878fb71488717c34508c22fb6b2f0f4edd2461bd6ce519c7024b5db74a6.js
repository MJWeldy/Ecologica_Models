'use strict';(function(){const indexCfg={cache:true};indexCfg.doc={id:'id',field:['title','content'],store:['title','href','section'],};const index=FlexSearch.create('balance',indexCfg);window.bookSearchIndex=index;index.add({'id':0,'href':'/docs/n-conditional-likelihood/','title':"Conditional Likelihood",'section':"Docs",'content':"Model Description #  Algebra #  $$\\hat{N} = \\frac{M_{t+1}}{1-\\prod^{t}(1-p_t)}$$\n$$y_{i,t} \\sim Bernoulli(p_t) $$\nSimulation #  N \u0026lt;- 150 #True population size n_occ \u0026lt;- 4 #Number of trapping occasions p \u0026lt;- 0.50 #Probability of first detection true_detections \u0026lt;- array(NA, dim=c(N,n_occ)) for (t in 1:n_occ){ true_detections[,t] \u0026lt;- rbinom(n=N,size=1,prob=p) } observed \u0026lt;- true_detections[apply(true_detections,1,max) == 1,] MNKA \u0026lt;- nrow(observed) print( paste0(\u0026#34;Number ever detected: \u0026#34;, MNKA,sep = \u0026#34; \u0026#34;) ) #number ever detected ## [1] \u0026quot;Number ever detected: 143 \u0026quot;\r JAGS #  library(R2jags) data \u0026lt;- list( y=observed, nsites=nrow(observed), MNKA=MNKA, n_occ=n_occ ) modelstring \u0026lt;- textConnection( \u0026#34; model { # Likelihood for(i in 1:nsites) { # observation model for(j in 1:4) { y[i, j] ~ dbern(p) } } for(t in 1:4){ p_un[t] \u0026lt;- (1-p) } # Priors p ~ dunif(0, 1) # Uninformative prior # Derived values N \u0026lt;- (MNKA / (1-prod(p_un[]))) } \u0026#34; ) parameters \u0026lt;- c(\u0026#34;p\u0026#34;,\u0026#34;N\u0026#34;) inits \u0026lt;- function() { list( ) } ni \u0026lt;- 10000 ; nt \u0026lt;- 1 ; nb \u0026lt;- 5000 ; nc \u0026lt;- 3 model \u0026lt;- jags(data, inits, parameters, modelstring, n.chains = nc, n.thin = nt, n.iter = ni, n.burnin = nb) library(knitr) ## Warning: package 'knitr' was built under R version 4.0.3\r kable(round(model$BUGSoutput$summary[c(1,3),c(1,2,3,7,8,9)],2))     mean sd 2.5% 97.5% Rhat n.eff     N 149.68 1.26 147.48 152.46 1 15000   p 0.54 0.02 0.50 0.58 1 15000    Stan #  library(rstan) data \u0026lt;- list( y=observed, nsites=nrow(observed), MNKA=MNKA, n_occ=n_occ ) stan_model \u0026lt;- \u0026#34; data { int\u0026lt;lower=0\u0026gt; MNKA; int\u0026lt;lower=0\u0026gt; nsites; int\u0026lt;lower=0\u0026gt; n_occ; int\u0026lt;lower=0,upper=1\u0026gt; y[MNKA, n_occ]; } parameters { real\u0026lt;lower=0, upper=1\u0026gt; p; } model { for(i in 1:nsites) for(j in 1:4) y[i, j] ~ bernoulli_lpmf(p); } generated quantities { real N = MNKA / (1-(1-p)^4); } \u0026#34; nc \u0026lt;- 4 stan.samples \u0026lt;- stan(model_code = stan_model, data = data, iter = 10000, chains = nc, cores = nc) library(knitr) kable(round(summary(stan.samples)$summary[c(2,1),c(1,2,3,4,8,10,9)],2))     mean se_mean sd 2.5% 97.5% Rhat n_eff     N 149.69 0.02 1.28 147.49 152.46 1 6756.62   p 0.54 0.00 0.02 0.50 0.58 1 6723.78    Comparison #  References #  \r"});index.add({'id':1,'href':'/docs/abundance/','title':"Abundance",'section':"Docs",'content':"Explanation of abundance modeling\n  "});index.add({'id':2,'href':'/docs/single-season/','title':"Single Season",'section':"Docs",'content':"Model Description #  Algebra #  Simulation #  y \u0026lt;- 1 {{\u0026lt; tabs “uniqueid” \u0026gt;}} {{\u0026lt; tab “JAGS” \u0026gt;}}\ndata \u0026lt;- list( y = y ) modelstring \u0026lt;- textConnection( \u0026#34; model{ # Likelihood for(i in 1:nSites) { # biological model z[i] ~ dbern(psi[i]) # observation model y[i] ~ dbin(p * z[i], n[i]) } # Priors psi ~ dunif(0, 1) p ~ dunif(1, 1) # Derived variable N \u0026lt;- sum(z) } \u0026#34; ) parameters \u0026lt;- c() inits \u0026lt;- function() { list() } ni \u0026lt;- 10000 nt \u0026lt;- 1 nb \u0026lt;- 5000 nc \u0026lt;- 3 #JagsModel \u0026lt;- jags(data, inits, parameters, modelstring, n.chains = nc, n.thin = nt, n.iter = ni, n.burnin = nb) {{\u0026lt; /tab \u0026gt;}} {{\u0026lt; tab “Stan” \u0026gt;}}\nStan \u0026lt;- code \u0026lt;- 1 {{\u0026lt; /tab \u0026gt;}} {{\u0026lt; tab “Greta” \u0026gt;}}\nGreta \u0026lt;- code \u0026lt;- 1 {{\u0026lt; /tab \u0026gt;}} {{\u0026lt; /tabs \u0026gt;}}\nComparison #  References #  \r"});index.add({'id':3,'href':'/docs/survival/','title':"Survival",'section':"Docs",'content':"Explanation of SURVIVAL modeling\n"});index.add({'id':4,'href':'/post/2020-12-01-r-rmarkdown/','title':"Hello R Markdown",'section':"Posts",'content':"\r\rR Markdown\rThis is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see http://rmarkdown.rstudio.com.\nYou can embed an R code chunk like this:\nsummary(cars)\r## speed dist ## Min. : 4.0 Min. : 2.00 ## 1st Qu.:12.0 1st Qu.: 26.00 ## Median :15.0 Median : 36.00 ## Mean :15.4 Mean : 42.98 ## 3rd Qu.:19.0 3rd Qu.: 56.00 ## Max. :25.0 Max. :120.00\rfit \u0026lt;- lm(dist ~ speed, data = cars)\rfit\r## ## Call:\r## lm(formula = dist ~ speed, data = cars)\r## ## Coefficients:\r## (Intercept) speed ## -17.579 3.932\r\rIncluding Plots\rYou can also embed plots. See Figure 1 for example:\npar(mar = c(0, 1, 0, 1))\rpie(\rc(280, 60, 20),\rc(\u0026#39;Sky\u0026#39;, \u0026#39;Sunny side of pyramid\u0026#39;, \u0026#39;Shady side of pyramid\u0026#39;),\rcol = c(\u0026#39;#0292D8\u0026#39;, \u0026#39;#F7EA39\u0026#39;, \u0026#39;#C4B632\u0026#39;),\rinit.angle = -50, border = NA\r)\r\rFigure 1: A fancy pie chart.\r\r\r"});})();